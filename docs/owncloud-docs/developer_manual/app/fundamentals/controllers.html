<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controllers :: ownCloud Documentation</title>
    <link rel="stylesheet" href="../../../../owncloud-docs/css/site.css">
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../..">ownCloud Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <a class="navbar-item" href="https://owncloud.org/news/">News</a>
        <a class="navbar-item" href="https://owncloud.org/features/">Features</a>
        <a class="navbar-item" href="https://demo.owncloud.org/">Demo</a>
        <a class="navbar-item" href="#">Documentation</a>
        <a class="navbar-item" href="https://owncloud.org/contribute/">Contribute</a>
        <a class="navbar-item" href="https://owncloud.org/support">Support</a>
        <a class="navbar-item" href="https://owncloud.com/">Enterprise Edition</a>
        <!--<div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>-->
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://owncloud.org/install/">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="owncloud-docs" data-version="master">
  <aside class="navigation" role="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../../index.html">ownCloud // Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">ROOT</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Appliance</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Ucs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../appliance/ucs/add-groups-and-users.html">Add groups and users</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../appliance/Active_Directory.html">Active Directory</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../appliance/Backup.html">Backup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../appliance/Clamav.html">ClamAV</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../appliance/Office.html">Office</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../appliance/certificates.html">Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../appliance/howto-update-owncloud.html">Howto update ownCloud</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../appliance/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../appliance/installation.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../appliance/login_information.html">Login Information</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../appliance/managing-ucs.html">Managing UCS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../appliance/what-is-it.html">What is it</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Database</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/database/db_conversion.html">DB Conversion</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/database/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/database/linux_database_configuration.html">Linux Database Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Files</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/files/external_storage/amazons3.html">AmazonS3</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/files/big_file_upload_configuration.html">Big File Upload Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/files/default_files_configuration.html">Default Files Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/files/encryption_configuration.html">Encryption Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/files/external_storage_configuration.html">External Storage Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/files/external_storage_configuration_gui.html">External Storage Configuration GUI</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/files/federated_cloud_sharing_configuration.html">Federated Cloud Sharing Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/files/file_sharing_configuration.html">File Sharing Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/files/file_versioning.html">File Versioning</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/files/files_locking_transactional.html">Files LOCking Transactional</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/files/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/files/previews_configuration.html">Previews Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/files/trashbin_options.html">Trashbin Options</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Ldap</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/ldap/ldap_proxy_cache_server_setup.html">LDAP Proxy Cache Server Setup</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Mimetypes</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/mimetypes/index.html">Index</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Server</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/security/password-policy.html">Password policy</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/activity_configuration.html">Activity Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/antivirus_configuration.html">AntiVirus Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/automatic_configuration.html">Automatic Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/background_jobs_configuration.html">Background Jobs Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/caching_configuration.html">Caching Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/config_sample_php_parameters.html">Config Sample PHP Parameters</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/custom_client_repos.html">Custom Client Repos</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/email_configuration.html">Email Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/excluded_blacklisted_files.html">Excluded Blacklisted Files</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/external_sites.html">External Sites</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/harden_server.html">Harden Server</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/import_ssl_cert.html">Import SSL Cert</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/index_php_less_urls.html">Index PHP Less URLs</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/knowledgebase_configuration.html">Knowledgebase Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/language_configuration.html">Language Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/logging_configuration.html">Logging Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/oc_server_tuning.html">OC Server Tuning</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/occ_command.html">OCC Command</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/reverse_proxy_configuration.html">Reverse Proxy Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/security_setup_warnings.html">Security Setup Warnings</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/server/thirdparty_php_configuration.html">Thirdparty PHP Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">User</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/user/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/user/reset_admin_password.html">Reset Admin Password</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/user/reset_user_password.html">Reset User Password</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/user/user_auth_ftp_smb_imap.html">User Auth FTP SMB IMAP</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/user/user_auth_ldap.html">User Auth LDAP</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/user/user_configuration.html">User Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/user/user_provisioning_api.html">User Provisioning API</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../configuration/user/user_roles.html">User Roles</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../configuration/index.html">Index</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Enterprise</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Clients</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/clients/creating_branded_apps.html">Creating Branded Apps</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/clients/custom_client_repos.html">Custom Client Repos</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/clients/index.html">Index</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">External_storage</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/external_storage/enterprise_only_auth.html">Enterprise Only Auth</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/external_storage/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/external_storage/ldap_home_connector_configuration.html">LDAP Home Connector Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/external_storage/onedrive.html">OneDrive</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/external_storage/s3_swift_as_primary_object_store_configuration.html">S3 Swift As Primary Object Store Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/external_storage/sharepoint-integration_configuration.html">Sharepoint integration Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/external_storage/windows-network-drive_configuration.html">Windows network drive Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">File_management</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/file_management/files_tagging.html">Files Tagging</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/file_management/index.html">Index</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Firewall</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/firewall/file_firewall.html">File Firewall</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/firewall/index.html">Index</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Installation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/installation/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/installation/install.html">Install</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/installation/oracle_db_configuration.html">Oracle DB Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Logging</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/logging/enterprise_logging_apps.html">Enterprise Logging Apps</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/logging/index.html">Index</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Ransomware-protection</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/ransomware-protection/index.html">Index</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Server_branding</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/server_branding/enterprise_server_branding.html">Enterprise Server Branding</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/server_branding/index.html">Index</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">User_management</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/user_management/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../enterprise/user_management/user_auth_shibboleth.html">User Auth Shibboleth</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../enterprise/index.html">Index</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Faq</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../faq/index.html">Index</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Installation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Docker</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../installation/docker/index.html">Index</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Letsencrypt</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../installation/letsencrypt/apache.html">Apache</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../installation/letsencrypt/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../installation/letsencrypt/nginx.html">NGINX</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../installation/apps_management_installation.html">Apps Management Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../installation/apps_supported.html">Apps Supported</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../installation/changing_the_web_route.html">Changing the Web Route</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../installation/command_line_installation.html">Command Line Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../installation/configuration_notes_and_tips.html">Configuration Notes and Tips</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../installation/deployment_considerations.html">Deployment Considerations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../installation/deployment_recommendations.html">Deployment Recommendations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../installation/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../installation/installation_wizard.html">Installation Wizard</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../installation/linux_installation.html">Linux Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../installation/nginx_configuration.html">NGINX Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../installation/selinux_configuration.html">SELinux Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../installation/source_installation.html">Source Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../installation/system_requirements.html">System ReqUIrements</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../installation/troubleshooting.html">Troubleshooting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Issues</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../issues/code_signing.html">Code Signing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../issues/general_troubleshooting.html">General Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../issues/impersonate_users.html">Impersonate Users</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../issues/index.html">Index</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Maintenance</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../maintenance/backup.html">Backup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../maintenance/enable_maintenance.html">Enable Maintenance</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../maintenance/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../maintenance/manual_upgrade.html">Manual Upgrade</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../maintenance/manually-moving-data-folders.html">Manually moving data folders</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../maintenance/migrating.html">Migrating</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../maintenance/package_upgrade.html">Package Upgrade</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../maintenance/restore.html">Restore</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../maintenance/update.html">Update</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../maintenance/upgrade.html">Upgrade</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Upgrading</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../upgrading/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../upgrading/marketplace_apps.html">Marketplace Apps</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../upgrading/upgrade_php.html">Upgrade PHP</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contents.html">Contents</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../release_notes.html">Release Notes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../whats_new_admin.html">Whats New Admin</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">user manual</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">External_storage</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/external_storage/external_storage.html">External Storage</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/external_storage/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/external_storage/sharepoint_connecting.html">Sharepoint Connecting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Files</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Webgui</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../user_manual/files/webgui/comments.html">Comments</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../user_manual/files/webgui/custom_groups.html">Custom Groups</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../user_manual/files/webgui/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../user_manual/files/webgui/navigating.html">Navigating</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../user_manual/files/webgui/overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../user_manual/files/webgui/quota.html">Quota</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../user_manual/files/webgui/sharing.html">Sharing</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../user_manual/files/webgui/tagging.html">Tagging</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/files/access_webdav.html">Access Webdav</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/files/deleted_file_management.html">Deleted File Management</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/files/desktop_mobile_sync.html">Desktop Mobile Sync</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/files/encrypting_files.html">Encrypting Files</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/files/federated_cloud_sharing.html">Federated Cloud Sharing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/files/gallery_app.html">Gallery App</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/files/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/files/large_file_upload.html">Large File Upload</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/files/public_link_shares.html">Public Link Shares</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/files/troubleshooting.html">Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/files/version_control.html">Version Control</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Pim</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/pim/calendar.html">Calendar</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/pim/contacts.html">Contacts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/pim/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/pim/sync_ios.html">Sync Ios</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/pim/sync_kde.html">Sync Kde</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/pim/sync_osx.html">Sync Osx</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/pim/sync_thunderbird.html">Sync Thunderbird</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../user_manual/pim/troubleshooting.html">Troubleshooting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../user_manual/contents.html">Contents</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../user_manual/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../user_manual/session_management.html">Session Management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../user_manual/troubleshooting.html">Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../user_manual/userpreferences.html">Userpreferences</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../user_manual/webinterface.html">Webinterface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../user_manual/whats_new.html">Whats New</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">developer manual</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">App</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Advanced</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../advanced/code_signing.html">Code Signing</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../advanced/custom-cache-backend.html">Custom cache backend</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../advanced/custom-storage-backend.html">Custom storage backend</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../advanced/extstorage.html">Extstorage</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../advanced/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../advanced/l10n.html">L10N</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../advanced/storage-backend.html">Storage backend</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../advanced/two-factor-provider.html">Two factor provider</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../advanced/users.html">Users</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Fundamentals</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="api.html">API</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="backgroundjobs.html">Backgroundjobs</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="changelog.html">Changelog</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="classloader.html">ClaSSLoader</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="container.html">Container</a>
  </li>
  <li class="nav-item is-current-page" data-depth="4">
    <a class="nav-link" href="controllers.html">Controllers</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="css.html">CSS</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="database.html">Database</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="filesystem.html">Filesystem</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="hooks.html">Hooks</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="info.html">Info</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="js.html">JS</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="market_app.html">Market App</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="middleware.html">Middleware</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="publishing.html">Publishing</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="routes.html">Routes</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="templates.html">Templates</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="testing.html">Testing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Tutorial</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorial/database_connectivity.html">Database Connectivity</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorial/development_environment.html">Development Environment</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorial/finishing_touches.html">Finishing Touches</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorial/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorial/javascript_and_css.html">JavaScript and CSS</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorial/navigation.html">Navigation</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorial/request.html">Request</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorial/requirements.html">ReqUIrements</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorial/restful_api.html">Restful API</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorial/routes_and_controllers.html">Routes and Controllers</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorial/template_content.html">Template Content</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorial/testing.html">Testing</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorial/wiring_it_up.html">Wiring it Up</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../introduction.html">Introduction</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Bugtracker</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../bugtracker/codereviews.html">Codereviews</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../bugtracker/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../bugtracker/triaging.html">Triaging</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Commun</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../commun/help_and_communication.html">Help and Communication</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../commun/index.html">Index</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Core</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../core/acceptance-tests.html">Acceptance tests</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../core/configfile.html">Configfile</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../core/externalapi.html">ExternalAPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../core/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../core/introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../core/ocs-capabilities.html">OCS capabilities</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../core/ocs-recipient-api.html">OCS recipient API</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../core/ocs-share-api.html">OCS share API</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../core/theming.html">Theming</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../core/translation.html">Translation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../core/ui-testing.html">UI testing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../core/unit-testing.html">Unit testing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">General</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../general/backporting.html">Backporting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../general/code-of-conduct.html">Code of conduct</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../general/codingguidelines.html">CodingGUIdelines</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../general/debugging.html">Debugging</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../general/devenv.html">Devenv</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../general/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../general/performance.html">Performance</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../general/security.html">Security</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Mobile_development</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Android_library</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../mobile_development/android_library/examples.html">Examples</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../mobile_development/android_library/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../mobile_development/android_library/library_installation.html">Library Installation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Ios_library</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../mobile_development/ios_library/examples.html">Examples</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../mobile_development/ios_library/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../mobile_development/ios_library/library_installation.html">Library Installation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../mobile_development/index.html">Index</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Testing</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../testing/index.html">Index</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Webdav_api</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../webdav_api/comments.html">Comments</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../webdav_api/files_versions.html">Files Versions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../webdav_api/index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../webdav_api/tags.html">Tags</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../index.html">Index</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">ownCloud // Documentation</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">ownCloud // Documentation</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main" role="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
<nav class="crumbs" role="navigation" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="../../../index.html">ownCloud // Documentation</a></li>
    <li class="crumb">developer manual</li>
    <li class="crumb">App</li>
    <li class="crumb">Fundamentals</li>
    <li class="crumb"><a href="controllers.html">Controllers</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///Users/settermjd/Workspace/clients/ownCloud/antora-build/admin_manual/modules/developer_manual/pages/app/fundamentals/controllers.adoc">Edit this Page</a></div>
</div>
<article class="doc">
<h1>Controllers</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Controllers are used to connect routes &lt;routes&gt; with application logic.
Think of them as callbacks that are executed once a request has come in.
Controllers are defined inside the <code>lib/Controller/</code> directory. To
create a controller, extend the <code>Controller</code> class and create a method
that should be executed to handle a request.</p>
</div>
<div class="paragraph">
<p>Here is an example of how to do so.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;

// define a new author controller
class AuthorController extends Controller {
    // define the method to execute upon the request
    public function index() {

    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connecting-a-controller-and-a-route"><a class="anchor" href="#connecting-a-controller-and-a-route"></a>Connecting a Controller and a Route</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To connect a controller and a route the controller has to be registered
in the container like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\AppInfo;

use OCP\AppFramework\App;
use OCA\MyApp\Controller\AuthorApiController;

class Application extends application {

    public function __construct(array $urlParams=[]) {
        parent::__construct('myapp', $urlParams);

        $container = $this-&gt;getContainer();

        /**
         * Controllers
         */
        $container-&gt;registerService('AuthorApiController', function($c) {
            // register the controller in the container
            return new AuthorApiController(
                $c-&gt;query('AppName'),
                $c-&gt;query('Request')
            );
        });
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Every controller requires the application name and the request object to
be passed to their parent constructor. This can be done as shown in the
example code above.</p>
</div>
<div class="paragraph">
<p>The important part is not the class name, but rather the string which is
passed in as the first parameter of the <code>registerService</code> method.</p>
</div>
<div class="paragraph">
<p>The other part is the route name. An example route name would look like
this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>author_api#some_method</pre>
</div>
</div>
<div class="paragraph">
<p>This name is processed in the following way:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Remove the underscore and uppercase the next character:</p>
<div class="literalblock">
<div class="content">
<pre>authorApi#someMethod</pre>
</div>
</div>
</li>
<li>
<p>Then split the name at the # and uppercase the first letter of the
left part:</p>
<div class="literalblock">
<div class="content">
<pre>AuthorApi
someMethod</pre>
</div>
</div>
</li>
<li>
<p>Then append Controller to the first part:</p>
<div class="literalblock">
<div class="content">
<pre>AuthorApiController
someMethod</pre>
</div>
</div>
</li>
<li>
<p>Finally, retrieve the service listed under <code>AuthorApiController</code>
from the container, look up the parameters of the <code>someMethod</code> method in
the request, cast them if there are PHPDoc type annotations, and execute
the <code>someMethod</code> method on the controller with those parameters.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-request-parameters"><a class="anchor" href="#getting-request-parameters"></a>Getting Request Parameters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Parameters can be passed in many ways, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Extracting them from the URL using curly braces like <code>{key}</code> inside
the URL (see routes)</p>
</li>
<li>
<p>Appending them to the URL as a GET request (e.g. <code>?something=true</code>)</p>
</li>
<li>
<p>Setting the form’s encoding type as
<code>application/x-www-form-urlencoded</code> in a form request</p>
</li>
<li>
<p>Setting the encoding type as <code>application/json</code> in a <code>POST</code>, <code>PATCH</code>,
or <code>PUT</code> request</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These parameters can be accessed by adding them to the controller
method. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;

class PageController extends Controller {
    // this method will be executed with the id and name parameter taken
    // from the request
    public function doSomething($id, $name) {

    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to set default parameter values by using PHP default
method values. This allows common values to be omitted. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;

class PageController extends Controller {
    /**
     * @param int $id
     */
    public function doSomething($id, $name='john', $job='author') {
        // GET ?id=3&amp;job=killer
        // $id = 3
        // $name = 'john'
        // $job = 'killer'
    }
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="casting-parameters"><a class="anchor" href="#casting-parameters"></a>Casting Parameters</h3>
<div class="paragraph">
<p><code>URL</code>, <code>GET</code> and <code>application/x-www-form-urlencoded</code> have the problem
that every parameter is a string, meaning that <code>?doMore=false</code> would be
passed in as the string <code>'false'</code> which is not what one would expect. To
cast these to the correct types, simply add a PHPDoc comment, in the
form of <code>@param type $name</code>. Here’s a comprehensive example showing all
the options at once.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;

class PageController extends Controller {
    /**
     * @param int $id
     * @param bool $doMore
     * @param float $value
     */
    public function doSomething($id, $doMore, $value) {
        // GET /index.php/apps/myapp?id=3&amp;doMore=false&amp;value=3.5
        // =&gt; $id = 3
        //    $doMore = false
        //    $value = 3.5
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following types will be cast:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>bool</code> or <code>boolean</code></p>
</li>
<li>
<p><code>float</code></p>
</li>
<li>
<p><code>int</code> or <code>integer</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="json-parameters"><a class="anchor" href="#json-parameters"></a>JSON Parameters</h3>
<div class="paragraph">
<p>It is possible to pass JSON data using a <code>POST</code>, <code>PUT</code> or <code>PATCH</code>
request. To do that the <code>Content-Type</code> header has to be set to
<code>application/json</code>. The JSON will be parsed as an array. The first level
keys will be used to pass in the arguments, e.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /index.php/apps/myapp/authors
Content-Type: application/json
{
    "name": "test",
    "number": 3,
    "publisher": true,
    "customFields": {
        "mail": "test@example.com",
        "address": "Somewhere"
    }
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;

class PageController extends Controller {
    public function create($name, $number, $publisher, $customFields) {
        // $name = 'test'
        // $number = 3
        // $publisher = true
        // $customFields = ["mail" =&gt; "test@example.com", "address" =&gt; "Somewhere"]
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="reading-headers-files-cookies-and-environment-variables"><a class="anchor" href="#reading-headers-files-cookies-and-environment-variables"></a>Reading Headers, Files, Cookies and Environment Variables</h3>
<div class="paragraph">
<p>Headers, files, cookies, and environment variables can be accessed
directly from the request object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;
use OCP\IRequest;

class PageController extends Controller {
    public function someMethod() {
        $type = $this-&gt;request-&gt;getHeader('Content-Type');  // $_SERVER['HTTP_CONTENT_TYPE']
        $cookie = $this-&gt;request-&gt;getCookie('myCookie');    // $_COOKIES['myCookie']
        $file = $this-&gt;request-&gt;getUploadedFile('myfile');  // $_FILES['myfile']
        $env = $this-&gt;request-&gt;getEnv('SOME_VAR');          // $_ENV['SOME_VAR']
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Why should those values be accessed from the request object and not from
the global array like <code>$_FILES</code>? Simple:
<a href="http://c2.com/cgi/wiki?GlobalVariablesAreBad">because it’s bad practice</a>
and will make testing harder.</p>
</div>
</div>
<div class="sect2">
<h3 id="reading-and-writing-session-variables"><a class="anchor" href="#reading-and-writing-session-variables"></a>Reading and Writing Session Variables</h3>
<div class="paragraph">
<p>To set, get or modify session variables, the <code>ISession</code> object has to be
injected into the controller. Then session variables can be accessed
like this:</p>
</div>
<div class="paragraph">
<p>The session is closed automatically for writing, unless you add the
<code>@UseSession</code> annotation!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\ISession;
use OCP\IRequest;
use OCP\AppFramework\Controller;

class PageController extends Controller {

    private $session;

    public function __construct($AppName, IRequest $request, ISession $session) {
        parent::__construct($AppName, $request);
        $this-&gt;session = $session;
    }

    /**
     * The following annotation is only needed for writing session values
     * @UseSession
     */
    public function writeASessionVariable() {
        // read a session variable
        $value = $this-&gt;session['value'];

        // write a session variable
        $this-&gt;session['value'] = 'new value';
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="setting-cookies"><a class="anchor" href="#setting-cookies"></a>Setting Cookies</h3>
<div class="paragraph">
<p>Cookies can be set or modified directly on the response class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use DateTime;

use OCP\AppFramework\Controller;
use OCP\AppFramework\Http\TemplateResponse;
use OCP\IRequest;

class BakeryController extends Controller {
    /**
     * Adds a cookie "foo" with value "bar" that expires after user closes the browser
     * Adds a cookie "bar" with value "foo" that expires 2015-01-01
     */
    public function addCookie() {
        $response = new TemplateResponse(...);
        $response-&gt;addCookie('foo', 'bar');
        $response-&gt;addCookie('bar', 'foo', new DateTime('2015-01-01 00:00'));
        return $response;
    }

    /**
     * Invalidates the cookie "foo"
     * Invalidates the cookie "bar" and "bazinga"
     */
    public function invalidateCookie() {
        $response = new TemplateResponse(...);
        $response-&gt;invalidateCookie('foo');
        $response-&gt;invalidateCookies(['bar', 'bazinga']);
        return $response;
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>_
}
_</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="responses"><a class="anchor" href="#responses"></a>Responses</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Similar to how every controller receives a request object, every
controller method has to to return a Response. This can be in the form
of a <code>Response</code> subclass or in the form of a value that can be handled
by a registered responder.</p>
</div>
<div class="sect2">
<h3 id="json"><a class="anchor" href="#json"></a>JSON</h3>
<div class="paragraph">
<p>Returning JSON is simple, just pass an array to a <code>JSONResponse</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;
use OCP\AppFramework\Http\JSONResponse;

class PageController extends Controller {
    public function returnJSON() {
        $params = ['test' =&gt; 'hi'];
        return new JSONResponse($params);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because returning JSON is such an common task, there’s even a shorter
way to do this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;

class PageController extends Controller {
    public function returnJSON() {
        return ['test' =&gt; 'hi'];
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Why does this work? Because the dispatcher sees that the controller did
not return a subclass of a <code>Response</code> and asks the controller to turn
the value into a <code>Response</code>. That’s where responders come in.</p>
</div>
</div>
<div class="sect2">
<h3 id="responders"><a class="anchor" href="#responders"></a>Responders</h3>
<div class="paragraph">
<p>Responders are short functions that take a value and return a response.
They are used to return different kinds of responses based on a <code>format</code>
parameter which is supplied by the client. Think of an API that is able
to return both XML and JSON depending on if you call the URL with:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>?format=xml</pre>
</div>
</div>
<div class="paragraph">
<p>or:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>?format=json</pre>
</div>
</div>
<div class="paragraph">
<p>The appropriate responder is being chosen by the following criteria:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First the dispatcher checks the Request if there is a <code>format</code>
parameter, e.g.:</p>
<div class="literalblock">
<div class="content">
<pre>?format=xml</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>or:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/index.php/apps/myapp/authors.{format}</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>If there is none, take the <code>Accept</code> header, use the first mimetype and
cut off <code>application/</code>. In the following example the format would be
XML:</p>
<div class="literalblock">
<div class="content">
<pre>Accept: application/xml, application/json</pre>
</div>
</div>
</li>
<li>
<p>If there is no Accept header or the responder does not exist, format
defaults to <code>json</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default there is only a responder for JSON but more can be added
easily:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;
use OCP\AppFramework\Http\DataResponse;

class PageController extends Controller {

    public function returnHi() {
        // XMLResponse has to be implemented
        $this-&gt;registerResponder('xml', function($value) {
            if ($value instanceof DataResponse) {
                return new XMLResponse(
                    $value-&gt;getData(),
                    $value-&gt;getStatus(),
                    $value-&gt;getHeaders()
                );
            } else {
                return new XMLResponse($value);
            }
        });

        return ['test' =&gt; 'hi'];
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example would only return XML if the <code>format</code> parameter was
<code>XML</code>. If you want to return an XMLResponse regardless of the format
parameter, extend the Response class and return a new instance of it
from the controller method instead.</p>
</div>
<div class="paragraph">
<p>Because returning values works fine in case of a success but not in case
of failure that requires a custom HTTP error code, you can always wrap
the value in a <code>DataResponse</code>. This works for both normal responses and
error responses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;
use OCP\AppFramework\Http\DataResponse;
use OCP\AppFramework\Http\Http;

class PageController extends Controller {

    public function returnHi() {
        try {
            return new DataResponse(calculate_hi());
        } catch (\Exception $ex) {
            return new DataResponse(['msg' =&gt; 'not found!'], Http::STATUS_NOT_FOUND);
        }
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="templates"><a class="anchor" href="#templates"></a>Templates</h3>
<div class="paragraph">
<p>A template &lt;templates&gt; can be rendered by returning a
<code>TemplateResponse</code>. A <code>TemplateResponse</code> takes the following parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>appName</code>: tells the template engine in which application the template
should be located</p>
</li>
<li>
<p><code>templateName</code>: the name of the template inside the <code>template/</code> folder
without the .php extension</p>
</li>
<li>
<p><code>parameters</code>: optional array parameters that are available in the
template through $_, e.g.:</p>
<div class="literalblock">
<div class="content">
<pre>['key' =&gt; 'something']</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>can be accessed through:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$_['key']</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>renderAs</code>: defaults to <code>user</code>, tells ownCloud if it should include it
in the web interface, or in case blank is passed solely render the
template</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;
use OCP\AppFramework\Http\TemplateResponse;

class PageController extends Controller {
    public function index() {
        $templateName = 'main';  // will use templates/main.php
        $parameters = ['key' =&gt; 'hi'];
        return new TemplateResponse($this-&gt;appName, $templateName, $parameters);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="redirects"><a class="anchor" href="#redirects"></a>Redirects</h3>
<div class="paragraph">
<p>A redirect can be achieved by returning a <code>RedirectResponse</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;
use OCP\AppFramework\Http\RedirectResponse;

class PageController extends Controller {
    public function toGoogle() {
        return new RedirectResponse('https://google.com');
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="downloads"><a class="anchor" href="#downloads"></a>Downloads</h3>
<div class="paragraph">
<p>A file download can be triggered by returning a <code>DownloadResponse</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;
use OCP\AppFramework\Http\DownloadResponse;

class PageController extends Controller {
    public function downloadXMLFile() {
        $path = '/some/path/to/file.xml';
        $contentType = 'application/xml';

        return new DownloadResponse($path, $contentType);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="creating-custom-responses"><a class="anchor" href="#creating-custom-responses"></a>Creating Custom Responses</h3>
<div class="paragraph">
<p>If no premade <code>Response</code> object fits the needed use case, its possible
to extend the <code>Response</code> base class and create a custom one. The only
thing that needs to be implemented is the <code>render</code> method which returns
the result as string. Creating a custom <code>XMLResponse</code> class could look
like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Http;

use OCP\AppFramework\Http\Response;

class XMLResponse extends Response {

    private $xml;

    public function __construct(array $xml) {
        $this-&gt;addHeader('Content-Type', 'application/xml');
        $this-&gt;xml = $xml;
    }

    public function render() {
        $root = new SimpleXMLElement('&lt;root/&gt;');
        array_walk_recursive($this-&gt;xml, [$root, 'addChild']);
        return $xml-&gt;asXML();
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="streamed-and-lazily-rendered-responses"><a class="anchor" href="#streamed-and-lazily-rendered-responses"></a>Streamed and Lazily Rendered Responses</h3>
<div class="paragraph">
<p>By default all responses are rendered at once and sent as a string
through middleware. In certain cases this is not a desirable behavior,
for instance if you want to stream a file in order to save memory. To do
that, use the <code>OCP\\AppFramework\\Http\\StreamResponse</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;
use OCP\AppFramework\Http\StreamResponse;

class PageController extends Controller {

    public function downloadXMLFile() {
        return new StreamResponse('/some/path/to/file.xml');
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to use a custom, lazily rendered response simply implement
the interface <code>OCP\\AppFramework\\Http\\ICallbackResponse</code> for your
response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Http;

use OCP\AppFramework\Http\Response;
use OCP\AppFramework\Http\ICallbackResponse;

class LazyResponse extends Response implements ICallbackResponse {
    public function callback(IOutput $output) {
        // custom code in here
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because this code is rendered after several usually built in helpers,
you need to take care of errors and proper HTTP caching by yourself.</p>
</div>
</div>
<div class="sect2">
<h3 id="modifying-the-content-security-policy"><a class="anchor" href="#modifying-the-content-security-policy"></a>Modifying the Content Security Policy</h3>
<div class="paragraph">
<p>By default ownCloud disables all resources which are not served on the
same domain, forbids cross domain requests and disables inline CSS and
JavaScript by setting a
<a href="https://developer.mozilla.org/en-US/docs/Web/Security/CSP/Introducing_Content_Security_Policy">Content
Security Policy</a>. However if an application relies on third party media
or other features which are forbidden by the current policy the policy
can be relaxed.</p>
</div>
<div class="paragraph">
<p>Double check your content and edge cases before you relax the policy!
Also read the
<a href="https://developer.mozilla.org/en-US/docs/Web/Security/CSP/Introducing_Content_Security_Policy">documentation
provided by MDN</a></p>
</div>
<div class="paragraph">
<p>To relax the policy pass an instance of the Content Security Policy
class to your response. The methods on the class can be chained. The
following methods turn off security features by passing in <code>true</code> as the
<code>$isAllowed</code> parameter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>allowInlineScript</code> (bool $isAllowed)</p>
</li>
<li>
<p><code>allowInlineStyle</code> (bool $isAllowed)</p>
</li>
<li>
<p><code>allowEvalScript</code> (bool $isAllowed)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following methods whitelist domains by passing in a domain or * for
any domain:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>addAllowedScriptDomain</code> (string $domain)</p>
</li>
<li>
<p><code>addAllowedStyleDomain</code> (string $domain)</p>
</li>
<li>
<p><code>addAllowedFontDomain</code> (string $domain)</p>
</li>
<li>
<p><code>addAllowedImageDomain</code> (string $domain)</p>
</li>
<li>
<p><code>addAllowedConnectDomain</code> (string $domain)</p>
</li>
<li>
<p><code>addAllowedMediaDomain</code> (string $domain)</p>
</li>
<li>
<p><code>addAllowedObjectDomain</code> (string $domain)</p>
</li>
<li>
<p><code>addAllowedFrameDomain</code> (string $domain)</p>
</li>
<li>
<p><code>addAllowedChildSrcDomain</code> (string $domain)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following policy for instance allows images, audio, and videos from
other domains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;
use OCP\AppFramework\Http\TemplateResponse;
use OCP\AppFramework\Http\ContentSecurityPolicy;

class PageController extends Controller {
    public function index() {
        $response = new TemplateResponse('myapp', 'main');
        $csp = new ContentSecurityPolicy();
        $csp-&gt;addAllowedImageDomain('*');
            -&gt;addAllowedMediaDomain('*');
        $response-&gt;setContentSecurityPolicy($csp);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ocs"><a class="anchor" href="#ocs"></a>OCS</h3>
<div class="paragraph">
<p>This is purely for compatibility reasons. If you are planning to offer
an external API, go for a api instead.</p>
</div>
<div class="paragraph">
<p>In order to ease migration from OCS API routes to the application
Framework, an additional controller and response have been added. To
migrate your API you can use the <code>OCP\\AppFramework\\OCSController</code> base
class and return your data in the form of an array in the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\OCSController;

class ShareController extends OCSController {

    /**
     * @NoAdminRequired
     * @NoCSRFRequired
     * @PublicPage
     * @CORS
     */
    public function getShares() {
        return [
            'data' =&gt; [
                // actual data is in here
            ],
            // optional
            'statuscode' =&gt; 100,
            'status' =&gt; 'OK'
        ];
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The format parameter works out of the box, no intervention is required.</p>
</div>
</div>
<div class="sect2">
<h3 id="handling-errors"><a class="anchor" href="#handling-errors"></a>Handling Errors</h3>
<div class="paragraph">
<p>Sometimes a request should fail, for instance if an author with id 1 is
requested but does not exist. In that case use an appropriate
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes#4xx_Client_Error">HTTP
error code</a> to signal the client that an error occurred.</p>
</div>
<div class="paragraph">
<p>Each response subclass has access to the <code>setStatus</code> method which lets
you set an HTTP status code. To return a <code>JSONResponse</code> signaling that
the author with id 1 has not been found, use the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\AppFramework\Controller;
use OCP\AppFramework\Http;
use OCP\AppFramework\Http\JSONResponse;

class AuthorController extends Controller {
    public function show($id) {
        try {
            // try to get author with $id

        } catch (NotFoundException $ex) {
            return new JSONResponse([], Http::STATUS_NOT_FOUND);
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="authentication"><a class="anchor" href="#authentication"></a>Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default every controller method enforces the maximum security, which
is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ensure that the user is admin</p>
</li>
<li>
<p>Ensure that the user is logged in</p>
</li>
<li>
<p>Check the CSRF token</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Most of the time though it makes sense to also allow normal users to
access the page and the <code>PageController-&gt;index()</code> method should not
check the CSRF token because it has not yet been sent to the client and
because of that can’t work. To turn off checks the following
<em>Annotations</em> can be added before the controller:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@NoAdminRequired</code>: Also users that are not admins can access the page</p>
</li>
<li>
<p><code>@NoSubAdminRequired</code>: Allow normal users access to the page</p>
</li>
<li>
<p><code>@NoCSRFRequired</code>: Don’t check the CSRF token (use this wisely since
you might create a security hole, to understand what it does see
../../general/security)</p>
</li>
<li>
<p><code>@PublicPage</code>: Everyone can access the page without having to log in</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A controller method that turns off all checks would look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sourceCode hljs" data-lang="sourceCode">&lt;?php
namespace OCA\MyApp\Controller;

use OCP\IRequest;
use OCP\AppFramework\Controller;

class PageController extends Controller {
    /**
     * @NoAdminRequired
     * @NoCSRFRequired
     * @PublicPage
     */
    public function freeForAll() {

    }
}</code></pre>
</div>
</div>
</div>
</div>
</article>
  </main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../owncloud-docs/js/site.js"></script>
<script src="../../../../owncloud-docs/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
